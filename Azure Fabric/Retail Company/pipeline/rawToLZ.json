{"$schema":"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"Raw_Zone":{"type":"string"},"Landing_Zone":{"type":"string"},"FabricDataPipelines kexixa3165":{"type":"string"},"PowerBIDatasets kexixa3165":{"type":"string"}},"variables":{},"resources":[{"name":"rawToLZ","type":"pipelines","apiVersion":"2018-06-01","properties":{"activities":[{"name":"RebateRawToLZ","description":"Raw CSV files gets merged into a single table, incompatible rows are skipped","type":"Copy","dependsOn":[{"activity":"SalesRawToLZ","dependencyConditions":["Succeeded"]}],"policy":{"timeout":"0.12:00:00","retry":0,"retryIntervalInSeconds":30,"secureOutput":false,"secureInput":false},"typeProperties":{"source":{"type":"DelimitedTextSource","storeSettings":{"type":"LakehouseReadSettings","recursive":true,"enablePartitionDiscovery":false},"formatSettings":{"type":"DelimitedTextReadSettings","skipLineCount":0},"datasetSettings":{"annotations":[],"linkedService":{"name":"Raw_Zone","properties":{"annotations":[],"type":"Lakehouse","typeProperties":{"workspaceId":"da54367c-f39e-401d-b68a-d440a7b5c02d","artifactId":"[parameters('Raw_Zone')]","rootFolder":"Files"}}},"type":"DelimitedText","typeProperties":{"location":{"type":"LakehouseLocation","folderPath":"Rebate"},"columnDelimiter":",","escapeChar":"\\","firstRowAsHeader":true,"quoteChar":"\""},"schema":[]}},"sink":{"type":"LakehouseTableSink","tableActionOption":"OverwriteSchema","partitionOption":"None","datasetSettings":{"annotations":[],"linkedService":{"name":"Landing_Zone","properties":{"annotations":[],"type":"Lakehouse","typeProperties":{"workspaceId":"da54367c-f39e-401d-b68a-d440a7b5c02d","artifactId":"[parameters('Landing_Zone')]","rootFolder":"Tables"}}},"type":"LakehouseTable","schema":[],"typeProperties":{"table":"lz_rebate"}}},"enableStaging":false,"enableSkipIncompatibleRow":true,"translator":{"type":"TabularTranslator","mappings":[{"source":{"name":"Sales Rep ID","type":"String","physicalType":"String"},"sink":{"name":"Sales Rep ID","physicalType":"string"}},{"source":{"name":"Sales Rep Name","type":"String","physicalType":"String"},"sink":{"name":"Sales Rep Name","physicalType":"string"}},{"source":{"name":"Sales Rep Region","type":"String","physicalType":"String"},"sink":{"name":"Sales Rep Region","physicalType":"string"}},{"source":{"name":"Customer Country","type":"String","physicalType":"String"},"sink":{"name":"Customer Country","physicalType":"string"}},{"source":{"name":"Customer Region","type":"String","physicalType":"String"},"sink":{"name":"Customer Region","physicalType":"string"}},{"source":{"name":"Sale Location","type":"String","physicalType":"String"},"sink":{"name":"Sale Location","physicalType":"string"}},{"source":{"name":"CurrencyCode","type":"String","physicalType":"String"},"sink":{"name":"CurrencyCode","physicalType":"string"}},{"source":{"name":"Customer Name","type":"String","physicalType":"String"},"sink":{"name":"Customer Name","physicalType":"string"}},{"source":{"name":"Sale Transaction ID","type":"String","physicalType":"String"},"sink":{"name":"Sale Transaction ID","physicalType":"string"}},{"source":{"name":"Customer ID","type":"String","physicalType":"String"},"sink":{"name":"Customer ID","physicalType":"string"}},{"source":{"name":"Rebate Datetime","type":"String","physicalType":"String"},"sink":{"name":"Rebate Datetime","physicalType":"string"}},{"source":{"name":"Rebate Transaction ID","type":"String","physicalType":"String"},"sink":{"name":"Rebate Transaction ID","physicalType":"string"}},{"source":{"name":"Rebate Type","type":"String","physicalType":"String"},"sink":{"name":"Rebate Type","physicalType":"string"}},{"source":{"name":"Rebate Amount","type":"String","physicalType":"String"},"sink":{"name":"Rebate Amount","physicalType":"string"}}],"typeConversion":true,"typeConversionSettings":{"allowDataTruncation":true,"treatBooleanAsNumber":false}}}},{"name":"SalesRawToLZ","description":"Sales transction files are merged into single table. Incompatible rows are skipped","type":"Copy","dependsOn":[],"policy":{"timeout":"0.12:00:00","retry":0,"retryIntervalInSeconds":30,"secureOutput":false,"secureInput":false},"typeProperties":{"source":{"type":"DelimitedTextSource","storeSettings":{"type":"LakehouseReadSettings","recursive":true,"enablePartitionDiscovery":false},"formatSettings":{"type":"DelimitedTextReadSettings"},"datasetSettings":{"annotations":[],"linkedService":{"name":"Raw_Zone","properties":{"annotations":[],"type":"Lakehouse","typeProperties":{"workspaceId":"da54367c-f39e-401d-b68a-d440a7b5c02d","artifactId":"[parameters('Raw_Zone')]","rootFolder":"Files"}}},"type":"DelimitedText","typeProperties":{"location":{"type":"LakehouseLocation","folderPath":"Sales Transaction"},"columnDelimiter":",","escapeChar":"\\","firstRowAsHeader":true,"quoteChar":"\""},"schema":[]}},"sink":{"type":"LakehouseTableSink","tableActionOption":"OverwriteSchema","partitionOption":"None","applyVOrder":true,"datasetSettings":{"annotations":[],"linkedService":{"name":"Landing_Zone","properties":{"annotations":[],"type":"Lakehouse","typeProperties":{"workspaceId":"da54367c-f39e-401d-b68a-d440a7b5c02d","artifactId":"[parameters('Landing_Zone')]","rootFolder":"Tables"}}},"type":"LakehouseTable","schema":[],"typeProperties":{"table":"lz_sales_transaction"}}},"enableStaging":false,"enableSkipIncompatibleRow":true,"translator":{"type":"TabularTranslator","mappings":[{"source":{"name":"Sale Transaction ID","type":"String","physicalType":"String"},"sink":{"name":"Sale Transaction ID","physicalType":"string"}},{"source":{"name":"Sales Rep ID","type":"String","physicalType":"String"},"sink":{"name":"Sales Rep ID","physicalType":"string"}},{"source":{"name":"Sales Rep Name","type":"String","physicalType":"String"},"sink":{"name":"Sales Rep Name","physicalType":"string"}},{"source":{"name":"Sales Rep Country","type":"String","physicalType":"String"},"sink":{"name":"Sales Rep Country","physicalType":"string"}},{"source":{"name":"Sales Rep Country Code","type":"String","physicalType":"String"},"sink":{"name":"Sales Rep Country Code","physicalType":"string"}},{"source":{"name":"Sales Rep Region","type":"String","physicalType":"String"},"sink":{"name":"Sales Rep Region","physicalType":"string"}},{"source":{"name":"Sales Country Code","type":"String","physicalType":"String"},"sink":{"name":"Sales Country Code","physicalType":"string"}},{"source":{"name":"Customer ID","type":"String","physicalType":"String"},"sink":{"name":"Customer ID","physicalType":"string"}},{"source":{"name":"Customer Name","type":"String","physicalType":"String"},"sink":{"name":"Customer Name","physicalType":"string"}},{"source":{"name":"Customer Country","type":"String","physicalType":"String"},"sink":{"name":"Customer Country","physicalType":"string"}},{"source":{"name":"Customer Region","type":"String","physicalType":"String"},"sink":{"name":"Customer Region","physicalType":"string"}},{"source":{"name":"Customer Country Code","type":"String","physicalType":"String"},"sink":{"name":"Customer Country Code","physicalType":"string"}},{"source":{"name":"Unit Quantity","type":"String","physicalType":"String"},"sink":{"name":"Unit Quantity","physicalType":"string"}},{"source":{"name":"Sale Amount","type":"String","physicalType":"String"},"sink":{"name":"Sale Amount","physicalType":"string"}},{"source":{"name":"Sale Datetime","type":"String","physicalType":"String"},"sink":{"name":"Sale Datetime","physicalType":"string"}},{"source":{"name":"Product Details","type":"String","physicalType":"String"},"sink":{"name":"Product Details","physicalType":"string"}},{"source":{"name":"Product Code","type":"String","physicalType":"String"},"sink":{"name":"Product Code","physicalType":"string"}},{"source":{"name":"Sale Location","type":"String","physicalType":"String"},"sink":{"name":"Sale Location","physicalType":"string"}},{"source":{"name":"CurrencyCode","type":"String","physicalType":"String"},"sink":{"name":"CurrencyCode","physicalType":"string"}}],"typeConversion":true,"typeConversionSettings":{"allowDataTruncation":true,"treatBooleanAsNumber":false}}}},{"name":"Invoke tranformation","description":"Invoke next pipeline to perform transformation","type":"InvokePipeline","dependsOn":[{"activity":"RebateRawToLZ","dependencyConditions":["Succeeded"]}],"policy":{"timeout":"0.12:00:00","retry":2,"retryIntervalInSeconds":30,"secureOutput":false,"secureInput":false},"typeProperties":{"waitOnCompletion":true,"operationType":"InvokeFabricPipeline","pipelineId":"06ce8214-54ed-4724-ba70-74d3c7d6087a","workspaceId":"da54367c-f39e-401d-b68a-d440a7b5c02d","parameters":{}},"externalReferences":{"connection":"[parameters('FabricDataPipelines kexixa3165')]"}}],"lastModifiedByObjectId":"4ef999a6-01d0-4535-90e6-7a2bbe54adf8","lastPublishTime":"2025-09-23T00:27:20Z"},"dependsOn":[]},{"name":"Transformation","type":"pipelines","apiVersion":"2018-06-01","properties":{"activities":[{"name":"SalesLZToSZ","description":"Transform sales transactions bronze layer data and move it to silver layer","type":"TridentNotebook","dependsOn":[],"policy":{"timeout":"0.12:00:00","retry":2,"retryIntervalInSeconds":240,"secureOutput":false,"secureInput":false},"typeProperties":{"notebookId":"0156a336-1d09-4e9d-86e1-8c869051ac3f","workspaceId":"da54367c-f39e-401d-b68a-d440a7b5c02d"}},{"name":"RebateLZToSZ","description":"Transform rebate transactions bronze layer data and move it to silver layer","type":"TridentNotebook","dependsOn":[{"activity":"SalesLZToSZ","dependencyConditions":["Succeeded"]}],"policy":{"timeout":"0.12:00:00","retry":0,"retryIntervalInSeconds":300,"secureOutput":false,"secureInput":false},"typeProperties":{"notebookId":"a7268ca4-7b85-4518-9107-8963d495a879","workspaceId":"da54367c-f39e-401d-b68a-d440a7b5c02d"}},{"name":"Invoke dimension modelling","type":"InvokePipeline","dependsOn":[{"activity":"RebateLZToSZ","dependencyConditions":["Succeeded"]}],"policy":{"timeout":"0.12:00:00","retry":0,"retryIntervalInSeconds":30,"secureOutput":false,"secureInput":false},"typeProperties":{"waitOnCompletion":true,"operationType":"InvokeFabricPipeline","pipelineId":"dd75ad7b-8481-477e-a0af-bca680988e7d","workspaceId":"da54367c-f39e-401d-b68a-d440a7b5c02d","parameters":{}},"externalReferences":{"connection":"[parameters('FabricDataPipelines kexixa3165')]"}}],"lastModifiedByObjectId":"4ef999a6-01d0-4535-90e6-7a2bbe54adf8","lastPublishTime":"2025-09-23T01:02:29Z"},"dependsOn":[]},{"name":"Dimension modelling","type":"pipelines","apiVersion":"2018-06-01","properties":{"activities":[{"name":"SalesSZToSM","description":"Create sales fact and dimensions tables","type":"TridentNotebook","dependsOn":[],"policy":{"timeout":"0.12:00:00","retry":2,"retryIntervalInSeconds":300,"secureOutput":false,"secureInput":false},"typeProperties":{"notebookId":"eaf3680d-4f13-4fb5-b894-d4ef9f4e66d9","workspaceId":"da54367c-f39e-401d-b68a-d440a7b5c02d"}},{"name":"RebateSZToSM","description":"Create rebate fact and dimensions tables","type":"TridentNotebook","dependsOn":[{"activity":"SalesSZToSM","dependencyConditions":["Succeeded"]}],"policy":{"timeout":"0.12:00:00","retry":2,"retryIntervalInSeconds":300,"secureOutput":false,"secureInput":false},"typeProperties":{"notebookId":"b1cadbbc-5d77-4b61-bcf4-56aa6878c4b6","workspaceId":"da54367c-f39e-401d-b68a-d440a7b5c02d"}},{"name":"Semantic model refresh","description":"Refresh Power BI model","type":"PBISemanticModelRefresh","dependsOn":[{"activity":"RebateSZToSM","dependencyConditions":["Succeeded"]}],"policy":{"timeout":"0.12:00:00","retry":0,"retryIntervalInSeconds":30,"secureOutput":false,"secureInput":false},"typeProperties":{"method":"post","waitOnCompletion":true,"commitMode":"Transactional","operationType":"SemanticModelRefresh","groupId":"da54367c-f39e-401d-b68a-d440a7b5c02d","datasetId":"171093c6-7149-4e06-b1b0-363628d89228"},"externalReferences":{"connection":"[parameters('PowerBIDatasets kexixa3165')]"}}],"lastModifiedByObjectId":"4ef999a6-01d0-4535-90e6-7a2bbe54adf8","lastPublishTime":"2025-09-23T01:03:07Z"},"dependsOn":[]}]}